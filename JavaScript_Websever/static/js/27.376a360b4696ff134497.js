webpackJsonp([27],{usmx:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("4YfN"),s=i.n(a),o={components:{PagingQuery:i("rZX8").a},data:function(){return{loading:!1,dialogVisible:!1,formStatus:!1,itemModel:{},itemList:[],selectedIds:[],queryForm:{movieName:"",movieType:""},pager:{page:1,rows:5,total:0}}},computed:{isEdit:function(){return this.itemModel&&this.itemModel.id}},created:function(){this.getItemList()},methods:{onSaveSelected:function(e){this.selectedIds=e.map(function(e){return e.id})},onQueryList:function(){this.pager.page=1,this.getItemList()},getEmptyItem:function(){return{id:"",movieName:"",movieType:"",movieDate:"",durationTime:""}},onClickAdd:function(){this.dialogVisible=!0},onClickEdit:function(e){this.itemModel=s()({},e),this.dialogVisible=!0},onClickSetting:function(){this.$refs.selectPane.openDialog()},onCloseDialog:function(){this.formStatus=!1,this.itemModel=this.getEmptyItem(),this.$refs.form.resetFields()},setDync:function(e){this.$emit("setField",e)},getItemList:function(){var e=this;this.loading=!0;var t=this.pager,i=t.page,a=t.rows;this.$http.get("queryMovie",{params:s()({page:i,rows:a},this.queryForm)}).then(function(t){200===t.status?(e.itemList=t.data.rows,e.pager.total=t.data.total):e.$message.warning({message:t.body.message,duration:1500})},function(t){var i=t.response;e.$hp.resp(i)}).finally(function(){e.loading=!1})},onSaveItem:function(){var e=this;this.$refs.form.validate(function(t){if(t){e.formStatus=!0;var i=e.itemModel.id;e.$http[i?"put":"post"](i?"updateMovie":"addMovie",e.itemModel).then(function(t){200===t.status?(e.$message.success({message:(i?"修改":"新增")+"成功",duration:1500,showClose:!0}),e.dialogVisible=!1,e.getItemList()):e.$message.warning({message:t.data.message,duration:1500})},function(t){var i=t.response;e.$hp.resp(i)})}})},onDeleteItem:function(){var e=this;0!==this.selectedIds.length?this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return e.$http.delete("deleteMovie",{data:e.selectedIds})}).then(function(t){200===t.status?(e.$message.success({message:"删除成功",duration:1500,showClose:!0}),e.getItemList()):e.$message.warning({message:t.data.message,duration:1500})},function(t){var i=t.response;e.$hp.resp(i)}):this.$message("请选择需要删除的数据")}}},l={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-card",[i("div",{attrs:{slot:"header"},slot:"header"},[i("el-form",{attrs:{inline:"",model:e.queryForm}},[i("el-form-item",{attrs:{label:"名称："}},[i("el-input",{model:{value:e.queryForm.movieName,callback:function(t){e.$set(e.queryForm,"movieName",t)},expression:"queryForm.movieName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"类别："}},[i("el-select",{model:{value:e.queryForm.movieType,callback:function(t){e.$set(e.queryForm,"movieType",t)},expression:"queryForm.movieType"}},[i("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),e._l(e.$enum.movieType,function(e,t){return i("el-option",{key:t,attrs:{label:e,value:t}})})],2)],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onQueryList()}}},[i("i",{staticClass:"fas fa-search",attrs:{"aria-hidden":"true"}}),e._v(" 查 询\n        ")])],1)],1)],1),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onClickAdd()}}},[i("i",{staticClass:"fas fa-plus",attrs:{"aria-hidden":"true"}}),e._v(" 新 增\n  ")]),e._v(" "),i("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.onDeleteItem()}}},[i("i",{staticClass:"fas fa-trash-alt",attrs:{"aria-hidden":"true"}}),e._v(" 删 除\n  ")]),e._v(" "),i("el-table",{staticClass:"mar-t-sm",attrs:{border:"",stripe:"",full:"",data:e.itemList,loading:e.loading},on:{"selection-change":e.onSaveSelected}},[i("el-table-column",{attrs:{align:"center",label:"序号",type:"index",width:"50"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",type:"selection"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作",width:"55"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"primary",size:"small",title:"编辑"},on:{click:function(i){return e.onClickEdit(t.row)}}},[i("i",{staticClass:"fas fa-pencil-alt",attrs:{"aria-hidden":"true"}})])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text"},on:{click:function(i){return e.setDync(t.row)}}},[e._v(e._s(t.row.movieName))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"规格"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e.$enum.movieType[t.row.movieType])+"\n      ")]}}])}),e._v(" "),i("el-table-column",{attrs:{property:"movieDate",label:"等级"}}),e._v(" "),i("el-table-column",{attrs:{property:"durationTime",label:"库存"}}),e._v(" "),i("el-table-column",{attrs:{property:"durationTime",label:"类别"}})],1),e._v(" "),i("paging-query",{attrs:{pager:e.pager},on:{query:e.getItemList}}),e._v(" "),i("el-dialog",{attrs:{width:"60%",title:(e.isEdit?"编辑":"新增")+"电影信息",visible:e.dialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},close:e.onCloseDialog}},[i("el-form",{ref:"form",attrs:{"label-position":"right","label-width":"93px",model:e.itemModel}},[i("el-form-item",{attrs:{label:"电影名称："}},[i("el-input",{attrs:{size:"small",disabled:e.formStatus},model:{value:e.itemModel.movieName,callback:function(t){e.$set(e.itemModel,"movieName",t)},expression:"itemModel.movieName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"类型："}},[i("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",disabled:e.formStatus},model:{value:e.itemModel.movieType,callback:function(t){e.$set(e.itemModel,"movieType",t)},expression:"itemModel.movieType"}},e._l(e.$enum.movieType,function(e,t){return i("el-option",{key:t,attrs:{label:e,value:t-0}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"上映日期："}},[i("el-input",{attrs:{size:"small",disabled:e.formStatus},model:{value:e.itemModel.movieDate,callback:function(t){e.$set(e.itemModel,"movieDate",t)},expression:"itemModel.movieDate"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"时长："}},[i("el-input",{attrs:{size:"small",disabled:e.formStatus},model:{value:e.itemModel.durationTime,callback:function(t){e.$set(e.itemModel,"durationTime",t)},expression:"itemModel.durationTime"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary",size:"small",loading:e.formStatus},on:{click:function(t){return e.onSaveItem()}}},[i("i",{staticClass:"fas fa-save",attrs:{"aria-hidden":"true"}}),e._v(e._s(" 保 存"+(e.formStatus?"中":""))+"\n      ")]),e._v(" "),i("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[i("i",{staticClass:"fas fa-times",attrs:{"aria-hidden":"true"}}),e._v(" 关 闭\n      ")])],1)],1)],1)},staticRenderFns:[]},n=i("C7Lr")(o,l,!1,null,null,null);t.default=n.exports}});
//# sourceMappingURL=27.376a360b4696ff134497.js.map