webpackJsonp([15],{H4gw:function(t,e){},dG3C:function(t,e){},oA6S:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={name:"FileUpload",data:function(){return{disabled:!1,count:0,addDialogVisible:!1,fileList:[],tempList:[],formatData:{},selectedIds:[],id:"123435sfsf34edsfs",pager:{total:0,page:1,rows:15}}},computed:{nums:function(){return this.tempList.length},filesSize:function(){return this.tempList.map(function(t){return t.size/1024/1024})},isFileSize:function(){return this.filesSize.every(function(t){return t<10})},isFilesSize:function(){return this.filesSize.reduce(function(t,e){return t+e},0)<100}},created:function(){},watch:{tempList:function(){var t=this;this.tempList.forEach(function(e){t.$set(e,"size",e.size),t.$set(e,"fileType",e.raw.type)})},id:function(){this.getItemList()},count:function(){this.count===this.filesSize.length&&(this.disabled=!1,this.tempList=[],this.getItemList())}},methods:{uploadAll:function(){},EmptyList:function(){0!==this.tempList.length?this.tempList=[]:this.$message("当前列表数据为空")},onSaveSelected:function(t){this.selectedIds=t.map(function(t){return t.rowGuid})},onClickAdd:function(){this.tempList=[],this.addDialogVisible=!0},handleRemove:function(t,e){this.tempList=e},onFileChange:function(t,e){this.tempList=e},onClickUpload:function(){this.tempList.length?this.isFileSize?this.isFilesSize?(this.count=0,this.disabled=!0,this.$refs.addFile.submit()):this.$message.info("上传文件总大小不能超过100MB"):this.$message.info("单个文件大小不能超过10MB"):this.$message.info("请选择需要上传的附件")},getItemList:function(){var t=this,e=this.pager,s=e.page,i=e.rows;this.$http.get("res/document",{params:{page:s,rows:i,objectId:this.id}}).then(function(e){200===e.data.statusCode?t.fileList=e.data.rows:t.$message.warning({message:e.data.msg,duration:1500})},function(e){var s=e.response;t.$sys.resp(s)})},beforeUpload:function(t){this.formatData.param=new FormData,this.formatData.param.append("file",t,t.name),this.formatData.config={params:{objectId:this.id}}},onCreateItem:function(){var t=this;this.$http.post("res/document/upload",this.formatData.param,this.formatData.config).then(function(e){200===e.status?t.$message.success("上传成功"):t.$message.warning({message:e.data.message,duration:1500}),t.count++,t.addDialogVisible=!1},function(e){var s=e.response;t.count++,t.$sys.resp(s)})},onDeleteItem:function(){var t=this;0!==this.selectedIds.length?this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return t.$http.delete("res/document",{data:t.selectedIds})}).then(function(e){e.data>=1?(t.$message.success({message:"删除成功",duration:1500,showClose:!0}),t.getItemList()):t.$message.warning({message:e.data.msg,duration:1500})},function(e){var s=e.response;t.$sys.resp(s)}):this.$message("请选择需要删除的数据")}}},a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-card",{staticClass:"BatchUpload"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.onClickAdd()}}},[s("i",{staticClass:"fa fa-cloud-upload",attrs:{"aria-hidden":"true"}}),t._v(" 上传附件\n  ")]),t._v(" "),s("el-dialog",{attrs:{title:"文件上传","append-to-body":"",visible:t.addDialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.addDialogVisible=e}}},[s("el-upload",{ref:"addFile",staticClass:"one",attrs:{multiple:"",action:"","before-upload":t.beforeUpload,"file-list":t.tempList,"auto-upload":!1,"http-request":t.onCreateItem,"on-change":t.onFileChange,"on-remove":t.handleRemove}},[s("el-button",{attrs:{size:"small"}},[t._v("添加文件")]),t._v(" "),s("el-button",{staticStyle:{"margin-left":"10px"},attrs:{slot:"tip",size:"small"},on:{click:t.uploadAll},slot:"tip"},[t._v("上传全部未开始上传文件")]),t._v(" "),s("el-button",{staticStyle:{"margin-left":"10px"},attrs:{slot:"tip",size:"small"},on:{click:t.EmptyList},slot:"tip"},[t._v("清空列表")]),t._v(" "),s("span",{staticStyle:{"margin-left":"10px"},attrs:{slot:"tip"},slot:"tip"},[t._v("队列中文件个数："+t._s(t.nums))]),t._v(" "),s("div",{staticStyle:{margin:"10px"},attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传不超过 10MB 大小的文件, 且每次上传不超过 100MB 大小")])],1),t._v(" "),s("el-table",{staticClass:"mar-t-sm",attrs:{height:"300",border:"",stripe:"",data:t.tempList},on:{"selection-change":t.onSaveSelected}},[s("el-table-column",{attrs:{label:"序号",type:"index",align:"center",width:"52"}}),t._v(" "),s("el-table-column",{attrs:{align:"center",type:"selection"}}),t._v(" "),s("el-table-column",{attrs:{property:"name",label:"文件名"}}),t._v(" "),s("el-table-column",{attrs:{property:"fileType",label:"类型"}}),t._v(" "),s("el-table-column",{attrs:{property:"size",label:"大小"}}),t._v(" "),s("el-table-column",{attrs:{property:"status",label:"状态"}})],1)],1)],1)},staticRenderFns:[]};var n=s("C7Lr")(i,a,!1,function(t){s("dG3C"),s("H4gw")},"data-v-05ba325c",null);e.default=n.exports}});
//# sourceMappingURL=15.86b8d6e53b0d51c426e5.js.map